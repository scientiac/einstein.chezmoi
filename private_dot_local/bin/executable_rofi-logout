#!/usr/bin/env bash

DCONF_COLOR_SCHEME="/org/gnome/desktop/interface/color-scheme"
CURRENT_SCHEME=$(dconf read $DCONF_COLOR_SCHEME)

if [ "$CURRENT_SCHEME" = "'prefer-dark'" ]; then
  theme_option="lightmode"
else
  theme_option="darkmode"
fi

options="lock\nlogout\nreboot\npoweroff\nsuspend\n$theme_option"

choice=$(echo -e "$options" | rofi -dmenu -matching fuzzy -theme-str 'window { width: 49.5%; }')

case $choice in
"lock")
  blurlock & niri msg action power-off-monitors
  ;;
"logout")
  loginctl terminate-user $USER
  ;;
"reboot")
  systemctl reboot
  ;;
"poweroff")
  systemctl poweroff
  ;;
"suspend")
  systemctl suspend
  ;;
"darkmode"|"lightmode")
  themetoggle
  ;;
*)
  echo "No valid option selected."
  ;;
esac
